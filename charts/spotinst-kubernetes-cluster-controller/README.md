# spotinst-kubernetes-cluster-controller

![Version: 1.0.97](https://img.shields.io/badge/Version-1.0.97-informational?style=flat-square) ![AppVersion: 1.0.79](https://img.shields.io/badge/AppVersion-1.0.79-informational?style=flat-square)

A Helm chart for Ocean Controller. This chart is usually installed by the [Ocean Operator](https://github.com/spotinst/ocean-operator), but may also be run manually.

## Installation

1. Add the Spot Helm chart repository:

```sh
helm repo add spotinst https://spotinst.github.io/spotinst-kubernetes-helm-charts
```

2. Update your local Helm chart repository cache:

```sh
helm repo update
```

3. Install `spotinst-kubernetes-cluster-controller`:

```sh
helm install my-release spotinst/spotinst-kubernetes-cluster-controller \
  --set spotinst.token=REDACTED \
  --set spotinst.account=REDACTED \
  --set spotinst.clusterIdentifier=REDACTED \
  # [...]
```

> NOTE: Please configure all required chart values using the `set` command line argument or a `values.yaml` file.

## Requirements

| Repository                                       | Name           | Version |
| ------------------------------------------------ | -------------- | ------- |
| https://kubernetes-charts.storage.googleapis.com | metrics-server | 2.8.8   |

## Values

| Key                            | Type   | Default                                                                                                                                                                                                                                                                                                                                    | Description                                                                                                                                                                                      |
| ------------------------------ | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| affinity.nodeAffinity          | object | `{"preferredDuringSchedulingIgnoredDuringExecution":[{"preference":{"matchExpressions":[{"key":"node-role.kubernetes.io/master","operator":"Exists"}]},"weight":100}],"requiredDuringSchedulingIgnoredDuringExecution":{"nodeSelectorTerms":[{"matchExpressions":[{"key":"kubernetes.io/os","operator":"NotIn","values":["windows"]}]}]}}` | (Optional) Node affinity.                                                                                                                                                                        |
| affinity.podAntiAffinity       | object | `{"preferredDuringSchedulingIgnoredDuringExecution":[{"podAffinityTerm":{"labelSelector":{"matchExpressions":[{"key":"k8s-app","operator":"In","values":["spotinst-kubernetes-cluster-controller"]}]},"topologyKey":"kubernetes.io/hostname"},"weight":50}]}`                                                                              | (Optional) Pod anti-affinity.                                                                                                                                                                    |
| aksConnector.acdIdentifier     | string | `""`                                                                                                                                                                                                                                                                                                                                       | (Optional) Unique identifier used by the Ocean AKS Connector when importing an AKS cluster.                                                                                                      |
| aksConnector.enabled           | bool   | `true`                                                                                                                                                                                                                                                                                                                                     | (Optional) Controls whether the Ocean AKS Connector should be deployed (requires a valid `aksConnector.acdIdentifier`).                                                                          |
| aksConnector.image.pullPolicy  | string | `"Always"`                                                                                                                                                                                                                                                                                                                                 | (Optional) Image pull policy.                                                                                                                                                                    |
| aksConnector.image.pullSecrets | list   | `[]`                                                                                                                                                                                                                                                                                                                                       | (Optional) Image pull secrets.                                                                                                                                                                   |
| aksConnector.image.repository  | string | `"spotinst/ocean-aks-connector:1.0.8"`                                                                                                                                                                                                                                                                                                     | (Optional) Image repository.                                                                                                                                                                     |
| aksConnector.jobName           | string | `"spotinst-kubernetes-cluster-controller-aks-connector"`                                                                                                                                                                                                                                                                                   | (Optional) Job name.                                                                                                                                                                             |
| aksConnector.nodeSelector      | object | `{"kubernetes.azure.com/mode":"system"}`                                                                                                                                                                                                                                                                                                   | (Optional) Node selection constraints. Ref: https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector                                                                |
| aksConnector.resources         | object | `{}`                                                                                                                                                                                                                                                                                                                                       | (Optional) Resource requests and limits. Ref: http://kubernetes.io/docs/user-guide/compute-resources/                                                                                            |
| aksConnector.tolerations       | list   | `[{"key":"CriticalAddonsOnly","operator":"Exists"}]`                                                                                                                                                                                                                                                                                       | (Optional) Tolerations for nodes that have taints on them. Ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/                                                          |
| caBundleSecret.name            | string | `"spotinst-kubernetes-cluster-controller-ca-bundle"`                                                                                                                                                                                                                                                                                       | (Optional) Secret name.                                                                                                                                                                          |
| configMap.create               | bool   | `true`                                                                                                                                                                                                                                                                                                                                     | (Optional) Controls whether a ConfigMap should be created.                                                                                                                                       |
| configMap.name                 | string | `"spotinst-kubernetes-cluster-controller-config"`                                                                                                                                                                                                                                                                                          | (Optional) ConfigMap name.                                                                                                                                                                       |
| dnsConfig                      | object | `{}`                                                                                                                                                                                                                                                                                                                                       | (Optional) DNS config. Ref: https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/                                                                                             |
| dnsPolicy                      | string | `"Default"`                                                                                                                                                                                                                                                                                                                                | (Optional) DNS policy. Ref: https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pod-s-dns-policy                                                                            |
| image.pullPolicy               | string | `"Always"`                                                                                                                                                                                                                                                                                                                                 | (Optional) Image pull policy.                                                                                                                                                                    |
| image.pullSecrets              | list   | `[]`                                                                                                                                                                                                                                                                                                                                       | (Optional) Image pull secrets.                                                                                                                                                                   |
| image.repository               | string | `"gcr.io/spotinst-artifacts/kubernetes-cluster-controller"`                                                                                                                                                                                                                                                                                | (Optional) Image repository.                                                                                                                                                                     |
| metrics-server.args            | list   | `["--logtostderr"]`                                                                                                                                                                                                                                                                                                                        | (Optional) Arguments to pass to metrics-server on start up.                                                                                                                                      |
| metrics-server.deployChart     | bool   | `true`                                                                                                                                                                                                                                                                                                                                     | (Optional) Specifies whether the metrics-server chart should be deployed.                                                                                                                        |
| namespace                      | string | `"kube-system"`                                                                                                                                                                                                                                                                                                                            | (Optional) Default namespace.                                                                                                                                                                    |
| resources                      | object | `{}`                                                                                                                                                                                                                                                                                                                                       | (Optional) Resource requests and limits. Ref: http://kubernetes.io/docs/user-guide/compute-resources/                                                                                            |
| secret.create                  | bool   | `true`                                                                                                                                                                                                                                                                                                                                     | (Optional) Controls whether a Secret should be created.                                                                                                                                          |
| secret.enabled                 | bool   | `false`                                                                                                                                                                                                                                                                                                                                    | (Optional) Use a Secret instead of a ConfigMap to store credentials. Disabled for backward compatibility.                                                                                        |
| secret.name                    | string | `"spotinst-kubernetes-cluster-controller"`                                                                                                                                                                                                                                                                                                 | (Optional) Secret name.                                                                                                                                                                          |
| serviceAccount.create          | bool   | `true`                                                                                                                                                                                                                                                                                                                                     | (Optional) Controls whether a ServiceAccount should be created.                                                                                                                                  |
| serviceAccount.name            | string | `"spotinst-kubernetes-cluster-controller"`                                                                                                                                                                                                                                                                                                 | (Optional) Service account name.                                                                                                                                                                 |
| spotinst.account               | string | `""`                                                                                                                                                                                                                                                                                                                                       | (Required) Spot Account. Ref: https://docs.spot.io/administration/organizations?id=account                                                                                                       |
| spotinst.baseUrl               | string | `""`                                                                                                                                                                                                                                                                                                                                       | (Optional) Base URL.                                                                                                                                                                             |
| spotinst.clusterIdentifier     | string | `""`                                                                                                                                                                                                                                                                                                                                       | (Required) Unique identifier used by the Ocean Controller to connect between the Ocean backend and the Kubernetes cluster. Ref: https://docs.spot.io/ocean/tutorials/spot-kubernetes-controller/ |
| spotinst.disableAutoUpdate     | bool   | `false`                                                                                                                                                                                                                                                                                                                                    | (Optional) Disable auto update.                                                                                                                                                                  |
| spotinst.enableCsrApproval     | bool   | `false`                                                                                                                                                                                                                                                                                                                                    | (Optional) Enable CSR approval.                                                                                                                                                                  |
| spotinst.proxyUrl              | string | `""`                                                                                                                                                                                                                                                                                                                                       | (Optional) Proxy URL.                                                                                                                                                                            |
| spotinst.token                 | string | `""`                                                                                                                                                                                                                                                                                                                                       | (Required) Spot Token. Ref: https://docs.spot.io/administration/api/create-api-token                                                                                                             |
| tolerations                    | list   | `[{"effect":"NoExecute","key":"node.kubernetes.io/not-ready","operator":"Exists","tolerationSeconds":150},{"effect":"NoExecute","key":"node.kubernetes.io/unreachable","operator":"Exists","tolerationSeconds":150},{"key":"node-role.kubernetes.io/master","operator":"Exists"}]`                                                         | (Optional) Tolerations for nodes that have taints on them. Ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/                                                          |
| additionalLabels                    | object   | `{}`                                                         | (Optional) additional labels for pods. Ref: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/                                                          |
| podAnnotations                    | object   | `{}`                                                         | (Optional) additional annotation for pods. Ref: https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/                                                          |
---

Autogenerated from chart metadata using [helm-docs v1.5.0](https://github.com/norwoodj/helm-docs/releases/v1.5.0)
